(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{1209:function(e,t,s){"use strict";s(617)},1228:function(e,t,s){"use strict";s.r(t);var a=s(18),r=s(38),c=s(572),n=(s(578),s(1162),s(9),s(1164),s(1170),s(1171),s(1173),s(1174),s(1175),s(1178),s(1179),s(1180),s(1181),s(1182),s(1183),s(1184),s(1185),s(1187),s(1188),s(1189),s(1190),s(1191),s(1192),s(1193),s(1194),s(1198),s(1199),s(1200),s(44),s(1201),s(1203),s(1205),s(1206),s(1207),s(340),s(136)),i=s(188),o=s(1219),l=s(1208),u=s.n(l),d={data:function(){return{expire:!1,src:"",date:"",ctrl:parseInt(localStorage.getItem("ctrl"))||""}},mounted:function(){clearInterval(this.ctrl)},watch:{show:function(e){e&&this.getImg()}},computed:Object(c.a)({},Object(n.e)({show:function(e){return e.qrcodeShow}})),methods:{getImg:function(){var e=this;return Object(r.a)(Object(a.a)().mark((function t(){var s,r,c,n,l,u;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return clearInterval(e.ctrl),(s=localStorage.getItem("scene"))?e.scene=s:(e.scene=Object(o.a)(),localStorage.setItem("scene",e.scene)),e.expire=!1,t.next=6,Object(i.b)({scene:e.scene});case 6:for(r=t.sent,c=new Uint8Array(r),n="",l=c.byteLength,u=0;u<l;u++)n+=String.fromCharCode(c[u]);e.src="data:image/png;base64,"+window.btoa(n),e.date=new Date,e.checkLogin();case 14:case"end":return t.stop()}}),t)})))()},checkLogin:function(){var e=this;this.ctrl=setInterval(Object(r.a)(Object(a.a)().mark((function t(){var s;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(i.e)({scene:e.scene});case 2:200===(s=t.sent).code&&s.data&&s.data.username&&(e.$store.commit("setUserInfo",s.data),e.$store.commit("setToken",s.token),e.$store.commit("setRefreshToken",s.refreshToken),e.hide()),Math.abs(u()(e.date).diff(u()()))>12e4&&(clearInterval(e.ctrl),e.expire=!0);case 6:case"end":return t.stop()}}),t)}))),2e3),localStorage.setItem("ctrl",this.ctrl)},hide:function(){clearInterval(this.ctrl),this.$store.commit("setCodeShow",!1)}}},v=(s(1209),s(41)),h=Object(v.a)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.show?s("div",{on:{click:e.hide}},[s("div",{staticClass:"wrapper"},[s("div",{staticClass:"info"},[e._v("打开微信扫一扫")]),e._v(" "),s("div",{staticClass:"box"},[s("div",{staticClass:"qrcode"},[s("img",{directives:[{name:"show",rawName:"v-show",value:e.src,expression:"src"}],staticClass:"box-img",attrs:{src:e.src,alt:"qrcode"}}),e._v(" "),e.expire?s("div",{staticClass:"tips-mask"},[s("p",[e._v("小程序二维码状态已过期")])]):e._e()]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.expire,expression:"expire"}],staticClass:"resend",on:{click:function(t){return t.stopPropagation(),e.getImg.apply(null,arguments)}}},[e._v("重新获取二维码")])])]),e._v(" "),s("div",{staticClass:"mask"})]):e._e()}),[],!1,null,"1fb1386a",null);t.default=h.exports},617:function(e,t,s){}}]);